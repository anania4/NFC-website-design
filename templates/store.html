{% extends 'base.html' %}
{% load static %}

{% block title %}TAP Store - The Collection{% endblock %}

{% block content %}
<section class="store-section">
    <div class="store-header">
        <h2>The Collection</h2>
        <p>Timeless tools for the modern networker.</p>
    </div>

    <div class="store-grid">
        <!-- Product 1 -->
        <div class="product-card" onclick="openProduct('tap_classic')">
            <div class="product-image">
                <img src="{% static 'images/A.png' %}" alt="Tap Classic Black">
            </div>
            <div class="product-info">
                <h3>Tap Classic</h3>
                <p class="product-desc">Matte Black Finish. NFC Enabled.</p>
                <div class="product-action">
                    <span class="price">$29.99</span>
                    <button class="add-btn"
                        onclick="event.stopPropagation(); addToCart('tap_classic', 'Tap Classic', 29.99, '{% static 'images/A.png' %}')">Add
                        to
                        Cart</button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ==================== PRODUCT DETAIL VIEW ==================== -->
<section class="product-detail-section" id="product-detail" style="display: none;">
    <div class="detail-container">
        <!-- Back Button -->
        <button onclick="closeProduct()" class="back-btn">‚Üê Back to Collection</button>

        <div class="detail-grid">
            <!-- Left: Image -->
            <div class="detail-gallery">
                <img id="detail-img" src="{% static 'images/A.png' %}" alt="Product Image" class="detail-main-img">
            </div>

            <!-- Right: Info -->
            <div class="detail-info">
                <h1 id="detail-title">Product Name</h1>
                <span id="detail-price" class="detail-price">$0.00</span>
                <p id="detail-desc" class="detail-desc">Description goes here.</p>

                <button id="detail-add-btn" class="add-btn-large">Add to Cart</button>

                <!-- Accordions -->
                <div class="detail-accordion">
                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>On-going fees?</span>
                            <span class="icon">+</span>
                        </button>
                        <div class="accordion-content">
                            <p>No subscription required. You pay once for the card, and it's yours forever.</p>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>How do I customize my card?</span>
                            <span class="icon">+</span>
                        </button>
                        <div class="accordion-content">
                            <p>Once you receive your card, simply tap it to your phone to activate and set up your
                                profile instantly.</p>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <button class="accordion-header" onclick="toggleAccordion(this)">
                            <span>What can I customize in my digital profile?</span>
                            <span class="icon">+</span>
                        </button>
                        <div class="accordion-content">
                            <p>You can add your photo, contact details, social media links, websites, payments, and
                                much more.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    /* Product Data */
    const products = {
        'tap_classic': {
            id: 'tap_classic',
            name: 'Tap Classic',
            price: 29.99,
            image: '{% static 'images/A.png' %}',
            detailImage: '{% static 'images/card_detail.png' %}',
            desc: 'Sleek and streamlined, this no-fuss digital business card is the perfect way to instantly connect with your network. Matte Black Finish with premium NFC technology embedded.'
        }
    };

    function openProduct(id) {
        const product = products[id];
        if (!product) return;

        // Populate Data
        document.getElementById('detail-title').textContent = product.name;
        document.getElementById('detail-price').textContent = '$' + product.price.toFixed(2);
        document.getElementById('detail-desc').textContent = product.desc;
        document.getElementById('detail-img').src = product.detailImage || product.image;

        // Setup Add to Cart Button
        const addBtn = document.getElementById('detail-add-btn');
        addBtn.onclick = () => addToCart(product.id, product.name, product.price, product.image);

        // Toggle Views
        document.querySelector('.store-grid').style.display = 'none';
        document.querySelector('.store-header').style.display = 'none';
        document.getElementById('product-detail').style.display = 'block';

        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function closeProduct() {
        document.getElementById('product-detail').style.display = 'none';
        document.querySelector('.store-grid').style.display = 'flex';
        document.querySelector('.store-header').style.display = 'block';
    }

    function toggleAccordion(header) {
        const item = header.parentElement;
        item.classList.toggle('active');
    }
</script>
{% endblock %}